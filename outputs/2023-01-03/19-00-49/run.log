[2023-01-03 19:00:49,667][root][INFO] - 
vision_task: detection
vision_model: faster_rcnn_X_101_32x8d_FPN_3x
seed: 1
cuda:
  indices: 3
total_step: 50000
batch_size: 2
saving_period: 10000
data_path:
  base: /filtering/data
  detectron2: ${data_path.base}
  openimages: ${data_path.base}/open-images-v6-etri
  eval_img_dir: ${data_path.openimages}/validation
  eval_annot_dir: ${data_path.openimages}/annotations_5k
  coco_class: ${data_path.eval_annot_dir}/coco_classes.txt
  coco_labelmap: ${data_path.eval_annot_dir}/coco_label_map.pbtxt
  eval_img_list: ${data_path.eval_annot_dir}/${vision_task}_validation_input_5k.lst
  eval_annot_boxes: ${data_path.eval_annot_dir}/${vision_task}_validation_bbox_5k.csv
  eval_annot_labels: ${data_path.eval_annot_dir}/${vision_task}_validation_labels_5k.csv
  eval_annot_masks: '{data_path.eval_annot_dir}/segmentation_validation_masks_5k.csv'
  gt_segm_mask_dir: ${data_path.eval_annot_dir}/challenge_2019_validation_masks
output_dir: ./outputs/${now:%Y-%m-%d}/${now:%H-%M-%S}
command:
  mode: train
  name: filter_surrogate_single
  networks:
  - vision_network
  - filtering_network
  filtering_network:
    architecture:
      normalization: cn
      feature_modulation: false
    train: true
    optimizer:
      name: adam
      learning_rate: 0.0001
      scheduler: exponential
      final_lr_ratio: 0.1
  codec:
    name: surrogate
    quality: 6
  lmbda:
    mode: single
    log2_lmbda: 1
  control_input: false

[2023-01-03 19:00:53,237][root][INFO] - Output path: outputs/2023-01-03/19-00-49
[2023-01-03 19:00:55,907][fvcore.common.checkpoint][INFO] - [Checkpointer] Loading from https://dl.fbaipublicfiles.com/detectron2/COCO-Detection/faster_rcnn_X_101_32x8d_FPN_3x/139173657/model_final_68b088.pkl ...
[2023-01-03 19:00:55,908][iopath.common.file_io][INFO] - URL https://dl.fbaipublicfiles.com/detectron2/COCO-Detection/faster_rcnn_X_101_32x8d_FPN_3x/139173657/model_final_68b088.pkl cached in /root/.torch/iopath_cache/detectron2/COCO-Detection/faster_rcnn_X_101_32x8d_FPN_3x/139173657/model_final_68b088.pkl
[2023-01-03 19:00:56,102][fvcore.common.checkpoint][INFO] - Reading a file from 'Detectron2 Model Zoo'
[2023-01-03 19:01:16,608][detectron2.data.datasets.coco][INFO] - Loading /filtering/data/coco/annotations/instances_train2017.json takes 14.36 seconds.
[2023-01-03 19:01:17,268][detectron2.data.datasets.coco][INFO] - Loaded 118287 images in COCO format from /filtering/data/coco/annotations/instances_train2017.json
[2023-01-03 19:01:24,802][detectron2.data.build][INFO] - Removed 1021 images with no usable annotations. 117266 images left.
[2023-01-03 19:01:28,220][detectron2.data.build][INFO] - Distribution of instances among all 80 categories:
[36m|   category    | #instances   |   category   | #instances   |   category    | #instances   |
|:-------------:|:-------------|:------------:|:-------------|:-------------:|:-------------|
|    person     | 257253       |   bicycle    | 7056         |      car      | 43533        |
|  motorcycle   | 8654         |   airplane   | 5129         |      bus      | 6061         |
|     train     | 4570         |    truck     | 9970         |     boat      | 10576        |
| traffic light | 12842        | fire hydrant | 1865         |   stop sign   | 1983         |
| parking meter | 1283         |    bench     | 9820         |     bird      | 10542        |
|      cat      | 4766         |     dog      | 5500         |     horse     | 6567         |
|     sheep     | 9223         |     cow      | 8014         |   elephant    | 5484         |
|     bear      | 1294         |    zebra     | 5269         |    giraffe    | 5128         |
|   backpack    | 8714         |   umbrella   | 11265        |    handbag    | 12342        |
|      tie      | 6448         |   suitcase   | 6112         |    frisbee    | 2681         |
|     skis      | 6623         |  snowboard   | 2681         |  sports ball  | 6299         |
|     kite      | 8802         | baseball bat | 3273         | baseball gl.. | 3747         |
|  skateboard   | 5536         |  surfboard   | 6095         | tennis racket | 4807         |
|    bottle     | 24070        |  wine glass  | 7839         |      cup      | 20574        |
|     fork      | 5474         |    knife     | 7760         |     spoon     | 6159         |
|     bowl      | 14323        |    banana    | 9195         |     apple     | 5776         |
|   sandwich    | 4356         |    orange    | 6302         |   broccoli    | 7261         |
|    carrot     | 7758         |   hot dog    | 2884         |     pizza     | 5807         |
|     donut     | 7005         |     cake     | 6296         |     chair     | 38073        |
|     couch     | 5779         | potted plant | 8631         |      bed      | 4192         |
| dining table  | 15695        |    toilet    | 4149         |      tv       | 5803         |
|    laptop     | 4960         |    mouse     | 2261         |    remote     | 5700         |
|   keyboard    | 2854         |  cell phone  | 6422         |   microwave   | 1672         |
|     oven      | 3334         |   toaster    | 225          |     sink      | 5609         |
| refrigerator  | 2634         |     book     | 24077        |     clock     | 6320         |
|     vase      | 6577         |   scissors   | 1464         |  teddy bear   | 4729         |
|  hair drier   | 198          |  toothbrush  | 1945         |               |              |
|     total     | 849949       |              |              |               |              |[0m
[2023-01-03 19:01:28,234][detectron2.data.dataset_mapper][INFO] - [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[2023-01-03 19:01:28,234][detectron2.data.build][INFO] - Using training sampler TrainingSampler
[2023-01-03 19:01:28,234][detectron2.data.common][INFO] - Serializing 117266 elements to byte tensors and concatenating them all ...
[2023-01-03 19:01:30,926][detectron2.data.common][INFO] - Serialized dataset takes 452.00 MiB
[2023-01-03 19:01:32,344][root][INFO] - Start training.
[2023-01-03 19:02:49,347][root][INFO] - step:    100 | bpp_pred:  0.5909 | loss_r:  1.1818 | loss_d:  0.4018 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:04:08,120][root][INFO] - step:    200 | bpp_pred:  0.5025 | loss_r:  1.0050 | loss_d:  0.4390 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:05:25,726][root][INFO] - step:    300 | bpp_pred:  0.4683 | loss_r:  0.9365 | loss_d:  0.3696 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:06:43,165][root][INFO] - step:    400 | bpp_pred:  0.4677 | loss_r:  0.9353 | loss_d:  0.4784 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:08:02,280][root][INFO] - step:    500 | bpp_pred:  0.6685 | loss_r:  1.3370 | loss_d:  0.3510 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:09:21,379][root][INFO] - step:    600 | bpp_pred:  0.3167 | loss_r:  0.6334 | loss_d:  0.5278 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:10:39,362][root][INFO] - step:    700 | bpp_pred:  0.3555 | loss_r:  0.7110 | loss_d:  0.9038 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:11:58,171][root][INFO] - step:    800 | bpp_pred:  0.3630 | loss_r:  0.7259 | loss_d:  0.7123 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:13:17,289][root][INFO] - step:    900 | bpp_pred:  0.5854 | loss_r:  1.1707 | loss_d:  0.1711 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:14:36,114][root][INFO] - step:   1000 | bpp_pred:  0.4553 | loss_r:  0.9106 | loss_d:  0.2119 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:15:55,295][root][INFO] - step:   1100 | bpp_pred:  0.5279 | loss_r:  1.0558 | loss_d:  0.2369 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:17:16,307][root][INFO] - step:   1200 | bpp_pred:  0.4476 | loss_r:  0.8952 | loss_d:  0.2433 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:18:34,032][root][INFO] - step:   1300 | bpp_pred:  0.4233 | loss_r:  0.8466 | loss_d:  0.1813 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:19:53,948][root][INFO] - step:   1400 | bpp_pred:  0.4241 | loss_r:  0.8482 | loss_d:  0.4491 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:21:13,942][root][INFO] - step:   1500 | bpp_pred:  0.4400 | loss_r:  0.8799 | loss_d:  0.7097 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:22:57,618][root][INFO] - step:   1600 | bpp_pred:  0.2996 | loss_r:  0.5993 | loss_d:  0.3799 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:24:15,333][root][INFO] - step:   1700 | bpp_pred:  0.3536 | loss_r:  0.7073 | loss_d:  0.3840 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:25:34,862][root][INFO] - step:   1800 | bpp_pred:  0.3723 | loss_r:  0.7446 | loss_d:  0.1475 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:26:52,445][root][INFO] - step:   1900 | bpp_pred:  0.3864 | loss_r:  0.7729 | loss_d:  0.6750 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:28:08,555][root][INFO] - step:   2000 | bpp_pred:  0.3330 | loss_r:  0.6661 | loss_d:  0.4118 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:29:27,031][root][INFO] - step:   2100 | bpp_pred:  0.4970 | loss_r:  0.9941 | loss_d:  0.6446 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:30:44,324][root][INFO] - step:   2200 | bpp_pred:  0.4259 | loss_r:  0.8519 | loss_d:  0.1220 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:32:01,435][root][INFO] - step:   2300 | bpp_pred:  0.2931 | loss_r:  0.5861 | loss_d:  0.9133 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:33:18,682][root][INFO] - step:   2400 | bpp_pred:  0.4912 | loss_r:  0.9824 | loss_d:  0.0925 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:34:34,468][root][INFO] - step:   2500 | bpp_pred:  0.3415 | loss_r:  0.6830 | loss_d:  0.1862 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:35:52,975][root][INFO] - step:   2600 | bpp_pred:  0.4675 | loss_r:  0.9350 | loss_d:  0.0754 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:37:11,779][root][INFO] - step:   2700 | bpp_pred:  0.4225 | loss_r:  0.8451 | loss_d:  0.6080 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:38:30,069][root][INFO] - step:   2800 | bpp_pred:  0.3778 | loss_r:  0.7555 | loss_d:  0.4085 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:39:47,900][root][INFO] - step:   2900 | bpp_pred:  0.3906 | loss_r:  0.7812 | loss_d:  0.0886 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:41:08,198][root][INFO] - step:   3000 | bpp_pred:  0.4404 | loss_r:  0.8808 | loss_d:  0.3676 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:42:26,017][root][INFO] - step:   3100 | bpp_pred:  0.6099 | loss_r:  1.2197 | loss_d:  0.6212 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:43:46,403][root][INFO] - step:   3200 | bpp_pred:  0.3881 | loss_r:  0.7762 | loss_d:  0.2469 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:45:04,531][root][INFO] - step:   3300 | bpp_pred:  0.3334 | loss_r:  0.6668 | loss_d:  0.4746 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:46:22,704][root][INFO] - step:   3400 | bpp_pred:  0.4725 | loss_r:  0.9450 | loss_d:  1.4465 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:47:40,179][root][INFO] - step:   3500 | bpp_pred:  0.3240 | loss_r:  0.6480 | loss_d:  0.3620 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:48:57,538][root][INFO] - step:   3600 | bpp_pred:  0.3416 | loss_r:  0.6832 | loss_d:  0.2082 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:50:17,346][root][INFO] - step:   3700 | bpp_pred:  0.4847 | loss_r:  0.9693 | loss_d:  0.3107 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:51:37,488][root][INFO] - step:   3800 | bpp_pred:  0.4071 | loss_r:  0.8142 | loss_d:  0.2960 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:52:57,216][root][INFO] - step:   3900 | bpp_pred:  0.3793 | loss_r:  0.7586 | loss_d:  0.6288 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:54:16,703][root][INFO] - step:   4000 | bpp_pred:  0.4025 | loss_r:  0.8051 | loss_d:  0.4170 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:55:35,392][root][INFO] - step:   4100 | bpp_pred:  0.3865 | loss_r:  0.7731 | loss_d:  1.0349 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:56:52,169][root][INFO] - step:   4200 | bpp_pred:  0.4597 | loss_r:  0.9193 | loss_d:  0.8907 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:58:08,053][root][INFO] - step:   4300 | bpp_pred:  0.5276 | loss_r:  1.0553 | loss_d:  0.4910 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:59:25,870][root][INFO] - step:   4400 | bpp_pred:  0.3455 | loss_r:  0.6909 | loss_d:  0.8581 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:00:44,644][root][INFO] - step:   4500 | bpp_pred:  0.4497 | loss_r:  0.8995 | loss_d:  0.2234 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:02:03,799][root][INFO] - step:   4600 | bpp_pred:  0.3781 | loss_r:  0.7563 | loss_d:  0.2683 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:03:22,544][root][INFO] - step:   4700 | bpp_pred:  0.2554 | loss_r:  0.5108 | loss_d:  0.1392 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:04:40,538][root][INFO] - step:   4800 | bpp_pred:  0.3962 | loss_r:  0.7925 | loss_d:  0.6869 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:05:59,074][root][INFO] - step:   4900 | bpp_pred:  0.3325 | loss_r:  0.6651 | loss_d:  0.6130 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:07:17,625][root][INFO] - step:   5000 | bpp_pred:  0.2965 | loss_r:  0.5930 | loss_d:  0.1858 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:08:36,500][root][INFO] - step:   5100 | bpp_pred:  0.3389 | loss_r:  0.6778 | loss_d:  0.8786 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:09:56,198][root][INFO] - step:   5200 | bpp_pred:  0.3731 | loss_r:  0.7461 | loss_d:  0.4136 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:11:13,946][root][INFO] - step:   5300 | bpp_pred:  0.3252 | loss_r:  0.6503 | loss_d:  0.1250 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:12:32,516][root][INFO] - step:   5400 | bpp_pred:  0.3313 | loss_r:  0.6626 | loss_d:  0.1580 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:13:50,826][root][INFO] - step:   5500 | bpp_pred:  0.3754 | loss_r:  0.7508 | loss_d:  0.9273 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:15:08,304][root][INFO] - step:   5600 | bpp_pred:  0.3702 | loss_r:  0.7404 | loss_d:  0.4342 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:16:25,810][root][INFO] - step:   5700 | bpp_pred:  0.3704 | loss_r:  0.7407 | loss_d:  0.2007 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:17:43,903][root][INFO] - step:   5800 | bpp_pred:  0.3460 | loss_r:  0.6920 | loss_d:  0.5230 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:19:02,148][root][INFO] - step:   5900 | bpp_pred:  0.4028 | loss_r:  0.8055 | loss_d:  0.8351 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:20:19,790][root][INFO] - step:   6000 | bpp_pred:  0.3181 | loss_r:  0.6363 | loss_d:  0.1668 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:21:38,062][root][INFO] - step:   6100 | bpp_pred:  0.4349 | loss_r:  0.8698 | loss_d:  0.2349 | learning_rate/filtering_network:  0.0001 
