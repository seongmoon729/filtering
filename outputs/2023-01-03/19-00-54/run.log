[2023-01-03 19:00:54,989][root][INFO] - 
vision_task: detection
vision_model: faster_rcnn_X_101_32x8d_FPN_3x
seed: 1
cuda:
  indices: '2'
total_step: 50000
batch_size: 2
saving_period: 10000
data_path:
  base: /filtering/data
  detectron2: ${data_path.base}
  openimages: ${data_path.base}/open-images-v6-etri
  eval_img_dir: ${data_path.openimages}/validation
  eval_annot_dir: ${data_path.openimages}/annotations_5k
  coco_class: ${data_path.eval_annot_dir}/coco_classes.txt
  coco_labelmap: ${data_path.eval_annot_dir}/coco_label_map.pbtxt
  eval_img_list: ${data_path.eval_annot_dir}/${vision_task}_validation_input_5k.lst
  eval_annot_boxes: ${data_path.eval_annot_dir}/${vision_task}_validation_bbox_5k.csv
  eval_annot_labels: ${data_path.eval_annot_dir}/${vision_task}_validation_labels_5k.csv
  eval_annot_masks: '{data_path.eval_annot_dir}/segmentation_validation_masks_5k.csv'
  gt_segm_mask_dir: ${data_path.eval_annot_dir}/challenge_2019_validation_masks
output_dir: ./outputs/${now:%Y-%m-%d}/${now:%H-%M-%S}
command:
  mode: train
  name: filter_surrogate_fm
  networks:
  - vision_network
  - filtering_network
  filtering_network:
    architecture:
      normalization: cn
      feature_modulation: true
    train: true
    optimizer:
      name: adam
      learning_rate: 0.0001
      scheduler: exponential
      final_lr_ratio: 0.1
  codec:
    name: surrogate
    quality: 6
  lmbda:
    mode: parametrization
    min_log2_lmbda: -4
    max_log2_lmbda: 1
  control_input: true

[2023-01-03 19:00:57,490][root][INFO] - Output path: outputs/2023-01-03/19-00-54
[2023-01-03 19:00:59,991][fvcore.common.checkpoint][INFO] - [Checkpointer] Loading from https://dl.fbaipublicfiles.com/detectron2/COCO-Detection/faster_rcnn_X_101_32x8d_FPN_3x/139173657/model_final_68b088.pkl ...
[2023-01-03 19:00:59,991][iopath.common.file_io][INFO] - URL https://dl.fbaipublicfiles.com/detectron2/COCO-Detection/faster_rcnn_X_101_32x8d_FPN_3x/139173657/model_final_68b088.pkl cached in /root/.torch/iopath_cache/detectron2/COCO-Detection/faster_rcnn_X_101_32x8d_FPN_3x/139173657/model_final_68b088.pkl
[2023-01-03 19:01:00,256][fvcore.common.checkpoint][INFO] - Reading a file from 'Detectron2 Model Zoo'
[2023-01-03 19:01:22,575][detectron2.data.datasets.coco][INFO] - Loading /filtering/data/coco/annotations/instances_train2017.json takes 15.29 seconds.
[2023-01-03 19:01:23,384][detectron2.data.datasets.coco][INFO] - Loaded 118287 images in COCO format from /filtering/data/coco/annotations/instances_train2017.json
[2023-01-03 19:01:31,036][detectron2.data.build][INFO] - Removed 1021 images with no usable annotations. 117266 images left.
[2023-01-03 19:01:34,414][detectron2.data.build][INFO] - Distribution of instances among all 80 categories:
[36m|   category    | #instances   |   category   | #instances   |   category    | #instances   |
|:-------------:|:-------------|:------------:|:-------------|:-------------:|:-------------|
|    person     | 257253       |   bicycle    | 7056         |      car      | 43533        |
|  motorcycle   | 8654         |   airplane   | 5129         |      bus      | 6061         |
|     train     | 4570         |    truck     | 9970         |     boat      | 10576        |
| traffic light | 12842        | fire hydrant | 1865         |   stop sign   | 1983         |
| parking meter | 1283         |    bench     | 9820         |     bird      | 10542        |
|      cat      | 4766         |     dog      | 5500         |     horse     | 6567         |
|     sheep     | 9223         |     cow      | 8014         |   elephant    | 5484         |
|     bear      | 1294         |    zebra     | 5269         |    giraffe    | 5128         |
|   backpack    | 8714         |   umbrella   | 11265        |    handbag    | 12342        |
|      tie      | 6448         |   suitcase   | 6112         |    frisbee    | 2681         |
|     skis      | 6623         |  snowboard   | 2681         |  sports ball  | 6299         |
|     kite      | 8802         | baseball bat | 3273         | baseball gl.. | 3747         |
|  skateboard   | 5536         |  surfboard   | 6095         | tennis racket | 4807         |
|    bottle     | 24070        |  wine glass  | 7839         |      cup      | 20574        |
|     fork      | 5474         |    knife     | 7760         |     spoon     | 6159         |
|     bowl      | 14323        |    banana    | 9195         |     apple     | 5776         |
|   sandwich    | 4356         |    orange    | 6302         |   broccoli    | 7261         |
|    carrot     | 7758         |   hot dog    | 2884         |     pizza     | 5807         |
|     donut     | 7005         |     cake     | 6296         |     chair     | 38073        |
|     couch     | 5779         | potted plant | 8631         |      bed      | 4192         |
| dining table  | 15695        |    toilet    | 4149         |      tv       | 5803         |
|    laptop     | 4960         |    mouse     | 2261         |    remote     | 5700         |
|   keyboard    | 2854         |  cell phone  | 6422         |   microwave   | 1672         |
|     oven      | 3334         |   toaster    | 225          |     sink      | 5609         |
| refrigerator  | 2634         |     book     | 24077        |     clock     | 6320         |
|     vase      | 6577         |   scissors   | 1464         |  teddy bear   | 4729         |
|  hair drier   | 198          |  toothbrush  | 1945         |               |              |
|     total     | 849949       |              |              |               |              |[0m
[2023-01-03 19:01:34,430][detectron2.data.dataset_mapper][INFO] - [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[2023-01-03 19:01:34,430][detectron2.data.build][INFO] - Using training sampler TrainingSampler
[2023-01-03 19:01:34,430][detectron2.data.common][INFO] - Serializing 117266 elements to byte tensors and concatenating them all ...
[2023-01-03 19:01:37,734][detectron2.data.common][INFO] - Serialized dataset takes 452.00 MiB
[2023-01-03 19:01:39,734][root][INFO] - Start training.
[2023-01-03 19:03:00,609][root][INFO] - step:    100 | bpp_pred:  0.5980 | loss_r:  0.3280 | loss_d:  0.4700 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:04:20,300][root][INFO] - step:    200 | bpp_pred:  0.6713 | loss_r:  0.3981 | loss_d:  0.4380 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:05:39,753][root][INFO] - step:    300 | bpp_pred:  0.6732 | loss_r:  0.3102 | loss_d:  0.3778 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:06:59,695][root][INFO] - step:    400 | bpp_pred:  0.6065 | loss_r:  0.0959 | loss_d:  0.4223 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:08:21,723][root][INFO] - step:    500 | bpp_pred:  0.8339 | loss_r:  0.6463 | loss_d:  0.3396 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:09:42,306][root][INFO] - step:    600 | bpp_pred:  0.4112 | loss_r:  0.3704 | loss_d:  0.3816 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:11:03,324][root][INFO] - step:    700 | bpp_pred:  0.6051 | loss_r:  0.5395 | loss_d:  0.9763 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:12:24,811][root][INFO] - step:    800 | bpp_pred:  0.4199 | loss_r:  0.2484 | loss_d:  0.6801 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:13:43,921][root][INFO] - step:    900 | bpp_pred:  0.9583 | loss_r:  1.5480 | loss_d:  0.1001 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:15:04,670][root][INFO] - step:   1000 | bpp_pred:  0.7488 | loss_r:  0.4343 | loss_d:  0.2319 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:16:24,532][root][INFO] - step:   1100 | bpp_pred:  0.8835 | loss_r:  0.1178 | loss_d:  0.1899 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:17:45,886][root][INFO] - step:   1200 | bpp_pred:  0.6025 | loss_r:  0.4080 | loss_d:  0.1975 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:19:06,317][root][INFO] - step:   1300 | bpp_pred:  0.5899 | loss_r:  0.1314 | loss_d:  0.1460 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:20:26,748][root][INFO] - step:   1400 | bpp_pred:  0.6769 | loss_r:  0.2043 | loss_d:  0.3965 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:21:48,899][root][INFO] - step:   1500 | bpp_pred:  0.7125 | loss_r:  0.1392 | loss_d:  0.4912 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:23:08,035][root][INFO] - step:   1600 | bpp_pred:  0.3442 | loss_r:  0.3104 | loss_d:  0.4088 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:24:29,350][root][INFO] - step:   1700 | bpp_pred:  0.4362 | loss_r:  0.2436 | loss_d:  0.3223 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:25:48,204][root][INFO] - step:   1800 | bpp_pred:  0.4687 | loss_r:  0.3607 | loss_d:  0.1510 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:27:07,510][root][INFO] - step:   1900 | bpp_pred:  0.5014 | loss_r:  0.4695 | loss_d:  0.6141 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:28:28,072][root][INFO] - step:   2000 | bpp_pred:  0.5116 | loss_r:  0.1660 | loss_d:  0.3192 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:29:47,518][root][INFO] - step:   2100 | bpp_pred:  0.7036 | loss_r:  0.3138 | loss_d:  0.6244 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:31:06,369][root][INFO] - step:   2200 | bpp_pred:  0.5853 | loss_r:  0.1953 | loss_d:  0.0802 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:32:26,405][root][INFO] - step:   2300 | bpp_pred:  0.3521 | loss_r:  0.2483 | loss_d:  0.6608 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:33:47,024][root][INFO] - step:   2400 | bpp_pred:  0.7956 | loss_r:  0.7754 | loss_d:  0.0875 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:35:06,981][root][INFO] - step:   2500 | bpp_pred:  0.4776 | loss_r:  0.0731 | loss_d:  0.2141 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:36:25,670][root][INFO] - step:   2600 | bpp_pred:  0.9464 | loss_r:  0.0631 | loss_d:  0.0749 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:37:47,169][root][INFO] - step:   2700 | bpp_pred:  0.6534 | loss_r:  0.0925 | loss_d:  0.3656 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:39:07,160][root][INFO] - step:   2800 | bpp_pred:  0.5173 | loss_r:  0.0958 | loss_d:  0.2594 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:40:25,062][root][INFO] - step:   2900 | bpp_pred:  0.4314 | loss_r:  0.6947 | loss_d:  0.0869 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:41:43,604][root][INFO] - step:   3000 | bpp_pred:  0.7346 | loss_r:  0.1256 | loss_d:  0.2742 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:43:02,937][root][INFO] - step:   3100 | bpp_pred:  0.8944 | loss_r:  0.7488 | loss_d:  0.5268 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:44:24,856][root][INFO] - step:   3200 | bpp_pred:  0.6534 | loss_r:  0.1508 | loss_d:  0.2362 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:45:43,914][root][INFO] - step:   3300 | bpp_pred:  0.4851 | loss_r:  0.0639 | loss_d:  0.3255 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:47:04,781][root][INFO] - step:   3400 | bpp_pred:  0.9111 | loss_r:  0.0796 | loss_d:  1.0849 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:48:23,380][root][INFO] - step:   3500 | bpp_pred:  0.4400 | loss_r:  0.1448 | loss_d:  0.3112 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:49:42,027][root][INFO] - step:   3600 | bpp_pred:  0.4690 | loss_r:  0.3421 | loss_d:  0.1313 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:51:02,685][root][INFO] - step:   3700 | bpp_pred:  0.7160 | loss_r:  0.4461 | loss_d:  0.2767 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:52:24,214][root][INFO] - step:   3800 | bpp_pred:  0.5892 | loss_r:  0.0508 | loss_d:  0.2388 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:53:45,244][root][INFO] - step:   3900 | bpp_pred:  0.4342 | loss_r:  0.5149 | loss_d:  0.5790 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:55:04,818][root][INFO] - step:   4000 | bpp_pred:  0.4881 | loss_r:  0.2450 | loss_d:  0.2593 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:56:26,601][root][INFO] - step:   4100 | bpp_pred:  0.4313 | loss_r:  0.5140 | loss_d:  1.0705 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:57:41,983][root][INFO] - step:   4200 | bpp_pred:  0.4998 | loss_r:  0.6914 | loss_d:  0.6962 | learning_rate/filtering_network:  0.0001 
[2023-01-03 19:59:01,010][root][INFO] - step:   4300 | bpp_pred:  0.8422 | loss_r:  0.2842 | loss_d:  0.4324 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:00:20,078][root][INFO] - step:   4400 | bpp_pred:  0.4188 | loss_r:  0.1603 | loss_d:  0.8597 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:01:41,171][root][INFO] - step:   4500 | bpp_pred:  0.7307 | loss_r:  0.1410 | loss_d:  0.2517 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:03:01,905][root][INFO] - step:   4600 | bpp_pred:  0.4763 | loss_r:  0.2488 | loss_d:  0.2230 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:04:18,454][root][INFO] - step:   4700 | bpp_pred:  0.3304 | loss_r:  0.1335 | loss_d:  0.1495 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:05:39,056][root][INFO] - step:   4800 | bpp_pred:  0.4250 | loss_r:  0.2600 | loss_d:  0.6494 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:06:58,888][root][INFO] - step:   4900 | bpp_pred:  0.4729 | loss_r:  0.1767 | loss_d:  0.5731 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:08:18,695][root][INFO] - step:   5000 | bpp_pred:  0.3554 | loss_r:  0.1817 | loss_d:  0.2567 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:09:38,098][root][INFO] - step:   5100 | bpp_pred:  0.5148 | loss_r:  0.1241 | loss_d:  0.6822 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:11:00,580][root][INFO] - step:   5200 | bpp_pred:  0.4364 | loss_r:  0.4478 | loss_d:  0.3909 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:12:20,786][root][INFO] - step:   5300 | bpp_pred:  0.3839 | loss_r:  0.3507 | loss_d:  0.1248 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:13:40,776][root][INFO] - step:   5400 | bpp_pred:  0.4430 | loss_r:  0.1103 | loss_d:  0.1265 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:15:00,239][root][INFO] - step:   5500 | bpp_pred:  0.5128 | loss_r:  0.1571 | loss_d:  0.7919 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:16:21,285][root][INFO] - step:   5600 | bpp_pred:  0.5716 | loss_r:  0.3647 | loss_d:  0.4247 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:17:40,301][root][INFO] - step:   5700 | bpp_pred:  0.5947 | loss_r:  0.1859 | loss_d:  0.2373 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:18:59,778][root][INFO] - step:   5800 | bpp_pred:  0.5543 | loss_r:  0.0662 | loss_d:  0.4336 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:20:34,609][root][INFO] - step:   5900 | bpp_pred:  0.5556 | loss_r:  0.1435 | loss_d:  0.5540 | learning_rate/filtering_network:  0.0001 
[2023-01-03 20:21:54,788][root][INFO] - step:   6000 | bpp_pred:  0.3748 | loss_r:  0.0889 | loss_d:  0.1137 | learning_rate/filtering_network:  0.0001 
